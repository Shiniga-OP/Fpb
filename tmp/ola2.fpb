/*
comentarios
multi linhas
suportados
*/
#incluir "biblis/impressao.asm";
#incluir "biblis/texs.asm";
#incluir "biblis/mem.asm";

/* pré definição */
vazio testeAlteracoes(int s, int numero, car letra, bool flag);
vazio testeOperacoes();
vazio testeComparacoes();
vazio testeMemoria();
vazio testeLoops();

int textam(car* texto);
int texcar(car* texto, car alvo);
int texcmp(car* x, car* y);

vazio subscar(car[] array, car alvo, car novo);
vazio memcp(car[] array, car* p, int tam);

int somar(int a, int b) {
   escrever("valor a: ", a, "\n");
   escrever("valor b: ", b, "\n");
   retorne a + b;
}

vazio inicio() {
    escrever("Testando tipos básicos:\n");
    car letra = 'A';
    escrever("\ncaractere: ", letra);
    int numero = 42;
    escrever("\ninteiro: ", numero);
    flu pi = 3.14;
    escrever("\nflutuante: ", pi);
    bool flag = 1;
    escrever("\nbooleano: ", flag);

    escrever("\n\nTestando função soma:\n");
    int s = somar(5, 7);
    escrever("\nsoma com retorno 5 + 7 = esperando 12, veio: ", s);
    testeAlteracoes(s, numero, letra, flag);
}

vazio testeAlteracoes(int s, int numero, car letra, bool flag) {
    s = 5 + 7;
    escrever("\nsoma comum 5 + 7 = esperando 12, veio: ", s);

    escrever("\n\nTestando atribuições:\n");
    numero = 100;
    letra = 'Z';
    flag = 0;
    escrever("\nnovo inteiro: ", numero);
    escrever("\nnovo caractere: ", letra);
    escrever("\nnovo booleano: ", flag, "\n");
    // teste operações:
    testeOperacoes();
    testeComparacoes();
    testeLoops();
    testeMemoria();
}

vazio testeOperacoes() {
    escrever("\n\nTeste de operações matematicas:\n");
    // testando ordem de precedencia:
    escrever("operação 5 + 5 * 5, esperado: 30, veio: ", 5 + 5 * 5, "\n");
    escrever("operação (5 + 5) * 5, esperado: 50, veio: ", (5 + 5) * 5, "\n");

    escrever(5 + 5, "\n"); // expressão direta
    escrever(somar(5, 5), "\n"); // retorno passado direto
    
    escrever("10 % 3 = ?, esperado: 1, recebido: ", 10 % 3, "\n");
}

vazio testeComparacoes() {
    escrever("\nTeste comparações:\n\n");
    int x = 4;

    se(x > 5) {
        escrever("x é maior que 5\n");
    } senao se(x >= 5) {
        escrever("x é maior ou igual a 5\n");
    } senao escrever("x não é maior nem igual a 5\n");
    
    int y = 5;
    
    se(y >= 4 && x > 4) {
        escrever("y >= 4 && x > 4 é verdadeiro\n");
    } senao {
        escrever("y >= 4 && x > 4 é falso\n");
    }
    escrever("\nComparação com textos:\n\n");
    car* t1 = "texto 1";
    car* t2 = "texto 2";
    escrever(t1, "\n", t2, "\n");
    se(texcmp(t1, t2) == 1) {
        escrever("texto 1 é igual a texto 2\n");
    }
    se(texcmp(t1, t2) == 0) {
        escrever("texto 1 não é igual a texto 2\n");
    }
    se(texcmp(t1, t1) == 1) {
        escrever("o primeiro texto é texto 1");
    } senao {
        escrever("o primeiro texto não é texto 1");
    }
}

vazio testeMemoria() {
    escrever("\nTeste de array:\n");
    car[] array = "texto";
    escrever("\nvalor do array: ", array);
    array[0] = 'X';
    escrever("\narray mudado no indice 0: ", array);

    escrever("\n\nTeste de ponteiro:\n");
    car* ponteiro = "exemplo de ponteiro";
    
    escrever("\nponteiro texto, valor: ", ponteiro, "\ntamamho em bytes: ", textam(ponteiro));
    
    int i = texcar(ponteiro, 't');

    se(i >= 0) escrever("\no ponteiro tem t no indice: ", i);
    senao escrever("\no ponteiro não tem t\n");
    
    escrever("\nTeste de manipulação da memoria:\n");
    car[] array = "exemplo";
    escrever("\nArray padrão: ", array);
    
    car* p = "XxXmplo maior";
    
    memcp(array, p, textam(p));
    escrever("\nArray copiado da memoria: ", array);
    
    subscar(array, 'X', 'e');
    
    escrever("\nArray usando subscar(array, 'X', 'e'): ", array);
    
    escrever("\nTeste de acesso a itens array:\n");
    car ca = array[0];
    escrever("item do indice 0 do array: ", ca, "\n");
    
    int[] num = { 0, 1, 2, 5 };
    escrever("\nArray de inteiros: \n\n");
    por(int i = 0; i < 4; i = i + 1) {
        escrever("no indice: ", i, " valor: ", num[i], "\n");
    }
    flu[] flutuante = { 0.2, 1.5, 5.1, 5.1 };
    escrever("\nArray de flutuantes: \n\n");
    por(int i = 0; i < 4; i = i + 1) {
        escrever("no indice: ", i, " valor: ", flutuante[i], "\n");
    }
}

vazio testeLoops() {
    escrever("\n\nTeste de loops");
    escrever("\nEnquanto:");
    int i = 0;
    enq(i < 10) {
        escrever("\nvalor de i: ", i);
        i = i + 1;
    }
    escrever("\n\nPor:\n");
    por(int i = 0; i < 10; i = i + 1) {
        escrever("indice: ", i, "\n");
    }
}